<script>
$(function() {
	$('.thumbnails').sortable();
	$('.draggable').draggable({ revert: true });
	$('#drop').droppable({
		drop: function(event, ui) {
			$(this).find('p').html('dropped!');
		}
	});
});
</script>

<div class="row">
	<div class="span9">
		<div class="row">
		<!-- TODO: make directive for listing verses -->
		<div id="verses" ng-model="limit">
		<ul class="thumbnails">
			<li ng-repeat="verse in verses | filter:search | orderBy:order | limitTo:limit">
			<jc-verse>
			<div ng-model="verseColor" class="span4 thumbnail {{verseColor | bgColor:verse.memorized}}">
				<span jc-editable-text model="verse.title"></span>
				<i class="icon-arrow-right" title="to memorize" ng-click="showMemorizeForm()" ng-model="isMemorizing" ng-hide="isMemorizing"></i> 
				<i class="icon-arrow-left" title="to review" ng-click="hideMemorizeForm()" ng-show="isMemorizing"></i> 
				<i class="icon-info-sign" title="created on {{verse.created_at | date:'MM/dd/yy'}}"></i>
				<span ng-show="verse.memorized">
					<i class="icon-ok" title="last memorized on {{verse.last_memorized_at | date:'MM/dd/yy'}}"></i>
					<span title="times memorized">{{verse.memorized}}</span>
				</span>
				<button class="btn btn-large close pull-right"  ng-click="removeVerse($index)">&times;</button>  
				<hr /> 
				<p>
				<div ng-hide="isMemorizing">
					<span jc-editable-textarea model="verse.content"></span>
				</div>
				<div ng-bind-html-unsafe="diffResult" ng-hide="isMemorizing"></div>
				<form ng-submit="memorizeVerse()" ng-show="isMemorizing">
					<textarea rows="5" class="input-xlarge" ng-model="typedContent" placeholder="type verse to memorize"></textarea><br />
					<input type="submit" class="btn-primary" value="Submit">
				</form>
				</p>
			</div>
			</jc-verse>
			</li>
		</ul>
		<div id="load-more" ng-show="limit < verses.length">
			<button ng-click="limit=limit+10">Load More</button>
			{{limit}} / {{verses.length}}
		</div>
	</div>
	</div>
	
	</div>
	<div class="span3">
		Search: <input type="text" class="span2" ng-model="search"><br />
		Sort by: 
		<select ng-model="order" class="span2">
			<option value="memorized">Memorization</option>
			<option value="title">Title</option>
			<option value="created_at">Created Date</option>
			<option value="last_memorized_at">Last Memorized Date</option>
		</select>
		<div ng-controller="TagsCtrl">
			<ul class="unstyled">
				<li ng-repeat="tag in tags">
					<a class="draggable">
						<span jc-editable-text model="tag.name"></span>
					</a>
					<button class="btn btn-large close pull-right"  ng-click="deleteTag($index)">&times;</button>  
				</li>
			</ul>
			<form ng-submit="addTag()">
				<input type="text" ng-model="tagName" placeholder="add new tag">
				<input class="btn-primary" type="submit" value="add">
			</form>
		</div>
		<div id="drop">
			<p>Please drop here</p>
		</div>
	</div>
</div>

